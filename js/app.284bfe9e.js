(function(e){function t(t){for(var o,s,i=t[0],l=t[1],c=t[2],d=0,m=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&m.push(a[s][0]),a[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(m.length)m.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==a[l]&&(o=!1)}o&&(r.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},a={app:0},r=[];function s(e){return i.p+"js/"+({}[e]||e)+"."+{"chunk-2d22d746":"eea3ca8f"}[e]+".js"}function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,o){n=a[e]=[t,o]}));t.push(n[2]=o);var r,l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=s(e);var c=new Error;r=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+o+": "+r+")",c.name="ChunkLoadError",c.type=o,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout((function(){r({type:"timeout",target:l})}),12e4);l.onerror=l.onload=r,document.head.appendChild(l)}return Promise.all(t)},i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"102d":function(e,t,n){},2162:function(e,t,n){"use strict";n("45ff")},3145:function(e,t,n){},"3aea":function(e,t,n){},4343:function(e,t,n){},"45ff":function(e,t,n){},"4c1d":function(e,t){e.exports="data:image/png;base64,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"},"56d7":function(e,t,n){"use strict";n.r(t);var o=n("7a23");const a={id:"app"};function r(e,t){const n=Object(o["resolveComponent"])("router-view");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",a,[Object(o["createVNode"])(n)])}n("cc23");var s=n("6b0d"),i=n.n(s);const l={},c=i()(l,[["render",r]]);var d=c,u=n("6605");const m={class:"main"},p=Object(o["createElementVNode"])("div",{id:"screen",class:"screen"},null,-1);function h(e,t,n,a,r,s){const i=Object(o["resolveComponent"])("bigControl");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",m,[Object(o["createVNode"])(i),p])}var f=n("5a89"),b=n("8992"),g=n("4721"),y=n("34ad"),v=n("0ca5"),w=n("2132"),A=n("fd34");class O{constructor(e){this.id=e,this.element=document.getElementById(e)}initZThree(){this.scene=new f["yb"],this.TextureLoader=new f["Hb"],this.camera=new f["lb"](45,this.element.offsetWidth/this.element.offsetHeight,.1,1e3),this.camera.position.set(100,100,100),this.camera.lookAt(new f["Nb"](0,0,0)),this.renderer=new f["Qb"]({antialias:!0,alpha:!0,shadowMap:{enabled:!0,type:f["jb"]}}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.element.offsetWidth,this.element.offsetHeight),this.element.appendChild(this.renderer.domElement),this.gui=new b["a"],window.addEventListener("resize",()=>{this.camera.aspect=this.element.offsetWidth/this.element.offsetHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.element.offsetWidth,this.element.offsetHeight),this.cssRenderer&&this.cssRenderer.setSize(this.element.offsetWidth,this.element.offsetHeight)})}initHelper(){this.scene.add(new f["e"](100))}render(e){e(),this.frameId=requestAnimationFrame(()=>this.render(e))}initControl(){this.controls=new g["a"](this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.enableZoom=!0,this.controls.autoRotate=!1,this.controls.autoRotateSpeed=.4,this.controls.enablePan=!0}initRaycaster(e,t=this.scene.children,n="click"){this.raycaster=new f["vb"],this.rayFn=this.rayEventFn.bind(this,t,e),this.element.addEventListener(n,this.rayFn)}rayEventFn(e,t){let n=window.event,o={x:n.offsetX/this.element.offsetWidth*2-1,y:-n.offsetY/this.element.offsetHeight*2+1},a=this.fireRaycaster(o,e);t&&t(a,this,n,o)}fireRaycaster(e,t){this.raycaster.setFromCamera(e,this.camera);let n=this.raycaster.intersectObjects(t,!0);if(n.length>0){let e=n[0];return e}return!1}destroyRaycaster(e){this.raycaster=null,this.element.removeEventListener(e,this.rayFn)}initAmbientLight(){const e=new f["c"](4210752);this.scene.add(e)}initDirectionalLight(){const e=new f["p"](16777215,.5);e.position.set(100,300,-100),e.castShadow=!0,e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024,e.shadow.camera.near=.5,e.shadow.camera.far=500,e.shadow.camera.left=-100,e.shadow.camera.right=100,e.shadow.camera.top=100,e.shadow.camera.bottom=-100,e.shadow.bias=.05,e.shadow.normalBias=.05,this.scene.add(e)}loadModel(e){switch(e.type){case"rgbe":this.rgbeLoader||(this.rgbeLoader=new w["a"]),this.rgbeLoader.load(e.url,e.onload,e.onProgress,e.onError);break;case"gltf":case"glb":if(!this.gltfLoader){this.gltfLoader=new y["a"];let e=new v["a"];e.setDecoderPath("assets/draco/"),this.gltfLoader.setDRACOLoader(e)}this.gltfLoader.load(e.url,e.onload,e.onProgress,e.onError);break;default:break}}iterateLoad(e,t,n,o){let a=0,r=this;function s(){r.loadModel({type:e[a].type,url:e[a].url,onload:function(t){e[a].onload&&e[a].onload(t),a++,a<e.length?s():n()},onProgress:function(n){e[a].onProgress&&e[a].onProgress(n),t&&t(n,a)},onError:function(t){e[a].onError&&e[a].onError(t),o&&o(t,a)}})}s()}flyTo(e){e.position=e.position||[],e.controls=e.controls||[],e.duration=e.duration||1e3,e.easing=e.easing||A["a"].Easing.Linear.None;const t=this.camera.position,n=this.controls.target,o=new A["a"].Tween({x1:t.x,y1:t.y,z1:t.z,x2:n.x,y2:n.y,z2:n.z}).to({x1:e.position[0],y1:e.position[1],z1:e.position[2],x2:e.controls[0],y2:e.controls[1],z2:e.controls[2]},e.duration).easing(e.easing);return o.onStart(()=>{this.controls.enabled=!1,e.start instanceof Function&&e.start()}),o.onUpdate(()=>{this.controls.enabled=!1,this.camera.position.set(o._object.x1,o._object.y1,o._object.z1),this.controls.target.set(o._object.x2,o._object.y2,o._object.z2),this.controls.update(),e.update instanceof Function&&e.update()}),o.onComplete(()=>{this.controls.enabled=!0,e.done instanceof Function&&e.done()}),o.onStop(()=>{this.controls.enabled=!0,e.stop instanceof Function&&e.stop()}),o.start(),A["a"].add(o),o}modelMove(e,t){e.fromPosition=e.fromPosition||[],e.toPosition=e.toPosition||[],e.duration=e.duration||1e3,e.easing=e.easing||A["a"].Easing.Linear.None;const n=new A["a"].Tween({x1:e.fromPosition[0],y1:e.fromPosition[1],z1:e.fromPosition[2]}).to({x1:e.toPosition[0],y1:e.toPosition[1],z1:e.toPosition[2]},e.duration).easing(e.easing);return n.onStart(()=>{this.controls.enabled=!1,e.start instanceof Function&&e.start()}),n.onUpdate(()=>{this.controls.enabled=!1,t.position.set(n._object.x1,n._object.y1,n._object.z1),e.update instanceof Function&&e.update()}),n.onComplete(()=>{this.controls.enabled=!0,e.done instanceof Function&&e.done()}),n.onStop(()=>{this.controls.enabled=!0,e.stop instanceof Function&&e.stop()}),n.start(),A["a"].add(n),n}getModelWorldPosition(e){this.scene.updateMatrixWorld();const t=new f["Nb"];return e.getWorldPosition(t),t}}const j=new f["Hb"],B=1,x=j.load("texture/green_line.png");x.wrapS=x.wrapT=f["wb"],x.repeat.set(B,B);const k=j.load("texture/red_line.png");k.wrapS=k.wrapT=f["wb"],k.repeat.set(B,B);const E=j.load("texture/blue_line.png");E.wrapS=E.wrapT=f["wb"],E.repeat.set(.5,.5);const C=new f["X"]({color:48895,transparent:!0,opacity:.5,depthWrite:!1}),P=new f["X"]({color:48895,transparent:!0,opacity:.1,wireframe:!0}),F=new f["X"]({color:"black"}),S=new f["X"]({map:x,transparent:!0,side:f["q"],opacity:1}),M=new f["X"]({map:k,transparent:!0,side:f["q"],opacity:1}),T=new f["X"]({map:E,transparent:!0,side:f["q"],opacity:1});function D(e){return new Promise(t=>{e.controlGroup=new f["x"],e.scene.add(e.controlGroup),e.modelMaterials={},e.rayModel=[];let n=[{type:"rgbe",url:"texture/spree_bank_1k.hdr",onload:t=>{const n=new f["kb"](e.renderer);n.compileEquirectangularShader(),e.envMap=n.fromEquirectangular(t).texture}},{type:"gltf",url:"model/model4.glb",onload:t=>{console.log("模型加载完成:"),console.log(t),e.scene.add(t.scene),e.model=t.scene;const n=["路面"],o=["楼间隔","承重柱","玻璃","路灯面","停车线","顶亮面","车流线"];e.model.traverse(t=>{var a;t.material&&(e.modelMaterials[t.name]={material:t.material},"其余建筑_1"===t.name&&(t.material.envMap=e.envMap));let{x:r,y:s,z:i}=t.position;t.position_tmp={x:r,y:s,z:i},n.includes(null===t||void 0===t||null===(a=t.parent)||void 0===a?void 0:a.name)?t.receiveShadow=!0:(t.castShadow=!0,t.receiveShadow=!1),t.name.indexOf("车流线1")>-1&&(t.material=S),t.name.indexOf("车流线2")>-1&&(t.material=M),t.name.indexOf("车流线3")>-1&&(t.material=T);for(let e=0;e<o.length;e++){const n=o[e];if(t.name.indexOf(n)>-1){t.layers.enable(1);break}t.layers.enable(0)}})}}];e.iterateLoad(n,null,()=>{},()=>{console.log("模型加载出错")}),t()})}function N(e){for(let t=0;t<e.model.children.length;t++){const n=e.model.children[t];n.traverse(t=>{t.material&&(t.material=e.modelMaterials[t.name].material)})}}function z(e,t){const n=document.getElementsByClassName(t);for(let o=0;o<n.length;o++)n[o].onclick=null;e.instance.removeAll(e.controlGroup)}function L(e,t){var n;if(0!==(null===e||void 0===e||null===(n=e.controlGroup)||void 0===n||null===(n=n.children)||void 0===n?void 0:n.length)){t&&z(e,t);for(let t=e.controlGroup.children.length-1;t>=0;t--){let n=e.controlGroup.children[t];n.isMesh&&(n.geometry.dispose(),n.material.dispose(),e.controlGroup.remove(n))}}}var I=n("4c1d"),U=n.n(I);const R=e=>(Object(o["pushScopeId"])("data-v-01661784"),e=e(),Object(o["popScopeId"])(),e),H={class:"container"},Q=["onClick"],V=["checked"],G=R(()=>Object(o["createElementVNode"])("img",{src:U.a,alt:""},null,-1)),K=R(()=>Object(o["createElementVNode"])("p",null,"返回",-1)),W=[G,K];function Y(e,t,n,a,r,s){const i=Object(o["resolveComponent"])("layer"),l=Object(o["resolveComponent"])("tooltip");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createElementVNode"])("div",H,[Object(o["createElementVNode"])("form",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(a.controls,(e,t)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("label",{key:t,onClick:n=>a.activeFun(e,t)},[Object(o["createElementVNode"])("input",{type:"radio",name:"radio",checked:t===a.activeIndex},null,8,V),Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(e.name),1)],8,Q))),128))]),a.EventBus.isShowFloorBack?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{key:0,class:"back animated fadeIn",onClick:t[0]||(t[0]=(...e)=>a.backFloorBase&&a.backFloorBase(...e))},W)):Object(o["createCommentVNode"])("",!0)]),a.EventBus.isShowFloorBack?(Object(o["openBlock"])(),Object(o["createBlock"])(i,{key:0,layers:a.layerData,active:a.currentLayer,styles:{top:"55%",left:"72%",height:"400px"},onChange:a.changeLayer},null,8,["layers","active","onChange"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(l,{style:Object(o["normalizeStyle"])({visibility:a.state.roomTooltipStyle.show?"visible":"hidden",left:a.state.roomTooltipStyle.x+"px",top:a.state.roomTooltipStyle.y+"px"}),data:a.state.roomTooltipStyle},null,8,["style","data"])],64)}const X=["onClick"];function _(e,t,n,a,r,s){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:"layers",style:Object(o["normalizeStyle"])({top:n.styles.top,left:n.styles.left,height:n.styles.height})},[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(n.layers,(e,t)=>(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])(["layer",n.active===e?"active":""]),key:t+"layer",onClick:t=>s.handleClick(e)},Object(o["toDisplayString"])(e),11,X))),128))],4)}var J={name:"layer",components:{},props:{layers:{type:[Object,Array],default:()=>({c:{}})},active:{type:String,default:"1F"},styles:{type:Object,default:()=>({top:"48%",left:"1%",height:"400px"})}},data(){return{}},methods:{handleClick(e){this.$emit("change",e)}},mounted(){}};n("cc40"),n("2162");const Z=i()(J,[["render",_],["__scopeId","data-v-0fc8dd6a"]]);var q=Z;const $={class:"tooltip-wrapper"},ee={class:"tooltip bottom"},te={key:0},ne={key:0},oe={key:1},ae={key:1},re=["src"];function se(e,t,n,a,r,s){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",$,[Object(o["createElementVNode"])("div",ee,[Object(o["createElementVNode"])("h3",null,Object(o["toDisplayString"])(n.data["楼栋"]),1),Object(o["createElementVNode"])("h6",null,"楼层: "+Object(o["toDisplayString"])(n.data["楼层"]),1),"摄像头"!==n.data["type"]?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",te,[Object(o["createElementVNode"])("h6",null,"房间号："+Object(o["toDisplayString"])(n.data["房间号"]),1),"电"===n.data["type"]?(Object(o["openBlock"])(),Object(o["createElementBlock"])("h6",ne,"度数："+Object(o["toDisplayString"])(n.data["度数"])+"度",1)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("h6",oe,"用水量："+Object(o["toDisplayString"])(n.data["度数"])+"方",1))])):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",ae,[Object(o["createElementVNode"])("h6",null,"摄像头："+Object(o["toDisplayString"])(n.data["name"]),1),Object(o["createElementVNode"])("video",{autoplay:"",loop:"",controls:"",muted:"",src:n.data["视频"],style:{width:"300px"}},null,8,re)]))])])}var ie={name:"",components:{},props:["data"],mounted(){}};n("bff5");const le=i()(ie,[["render",se],["__scopeId","data-v-2dd96a2c"]]);var ce=le,de=n("32ab");const ue=["A栋","B栋","C栋","D栋"],me=["1F","2F","3F","4F","5F","6F","7F","8F","9F","10F"],pe=["101","102","103","104"],he={};ue.forEach(e=>{he[e]={},me.forEach(t=>{he[e][t]={},pe.forEach(n=>{he[e][t][n]={"水":f["U"].randInt(5,20),"电":f["U"].randInt(200,500)}})})}),console.log(he);const fe={"摄像头A":`movie/${f["U"].randInt(1,3)}.mp4`,"摄像头B":`movie/${f["U"].randInt(1,3)}.mp4`,"摄像头C":`movie/${f["U"].randInt(1,3)}.mp4`},be=[{name:"摄像头",x:0,y:.5,z:0,class:"camera-bg",type:"摄像头"},{name:"水管",x:0,y:.5,z:0,class:"water-bg",type:"电"},{name:"电表",x:0,y:.5,z:0,class:"electricity-bg",type:"电"}];function ge(e,t){e.flyTo({position:[0,35,113],controls:[0,0,0],done:()=>{ye(e,t)}})}function ye(e,t){e.model.traverse((function(t){if(t.name.indexOf("楼顶")>-1){const n=t.parent.name,o=Object.values(e.getModelWorldPosition(t)),a=`<div class="floorText-3d animated fadeIn" id="${n}"><p class="text">${n}</p></div>`;e.instance.add({element:a,position:o,scale:[.05,.05,.05],name:n,parent:e.controlGroup,cssObject:de["b"]})}}));const n=document.getElementsByClassName("floorText-3d");for(let o=0;o<n.length;o++){const a=n[o];a.onclick=()=>{z(e,"floorText-3d");for(let n=0;n<e.model.children.length;n++){const o=e.model.children[n];if(o.name===a.id){t.isShowFloorBack=!0,t.model=o;const n=Object.values(e.getModelWorldPosition(o));e.flyTo({position:[n[0]+40,n[1]+50,n[2]+40],controls:n}),o.traverse(t=>{t.material&&(t.material=e.modelMaterials[t.name].material)})}else o.traverse(e=>{e.material&&(e.material=C)})}}}}function ve(e,t,n){t.traverse((function(t){t.isMesh&&be.forEach(n=>{if(t.name.indexOf(n.name)>-1){const o=t.name,a=Object.values(e.getModelWorldPosition(t)),r=`<div class="room-3d animated fadeIn" id="${o}" _type="${n.type}"><p class="text">${o}</p><div class="${n.class}"></div></div>`;e.instance.add({element:r,position:a,scale:[.01,.01,.01],name:o,parent:e.controlGroup,cssObject:de["b"]})}})}));const o=document.getElementsByClassName("room-3d");for(let a=0;a<o.length;a++){const t=o[a];t.onclick=o=>{const a=t.getAttribute("_type"),r=e.model.getObjectByName(t.id);n.value={name:r.name,type:a,x:o.x,y:o.y,show:n.value.name!==r.name||!n.value.show},console.log(he)}}}function we(e,t,n,o,a,r){z(e,"room-3d"),z(e,"floorText-3d");const s=Number(n.substr(0,n.indexOf("F")));for(let i=0;i<t.children.length;i++){const l=t.children[i],c=l.name;let d;if(d=c.indexOf("楼顶")>-1?o.value.length+1:Number(c.substr(0,n.indexOf("F"))),!isNaN(d)){let o,i=d-s,c=l.position,u=l.position_tmp;o="全楼"===n?[u.x,u.y,u.z]:i>=1?[u.x,u.y+20,u.z]:[u.x,u.y,u.z],e.modelMove({fromPosition:[c.x,c.y,c.z],toPosition:o,duration:1e3,done:()=>{if("全楼"!==n)if(l.name.indexOf(n)>-1){if(r)return void r();const t=Object.values(e.getModelWorldPosition(l));e.flyTo({centerPosition:[t[0]+4,t[1]+10,t[2]+15],controls:t,done:()=>{ve(e,l,a)}})}else;else{if(r)return void r();const n=Object.values(e.getModelWorldPosition(t));e.flyTo({centerPosition:[n[0]+40,n[1]+50,n[2]+40],controls:n})}}},l)}}}n("14d9");var Ae=n("2295");function Oe(e,t){e.flyTo({position:[53,68.1,132.1],controls:[-3.85,-12.06,8.96],done:()=>{je(e,t)}})}function je(e,t){let n=0;e.model.traverse(t=>{if(t.isMesh)if(-1===t.name.indexOf("电表"))t.material=P;else{const o=t.parent.parent.name,a=t.parent.name.substr(0,2),r=t.name.substr(0,3),s=he[o][a][r]["电"];s>460&&(e.selectedObjects.push(t),n<6&&(setTimeout(()=>{Object(Ae["a"])({title:"警告",message:`${o}的${a}${r}的用电量为${s}度, 已超过平均标准，请留意`,type:"warning",duration:6e3})},200*n),n++),e.rayModel.push(t))}}),e.initRaycaster((e,n,o)=>{if(e){const n=e.object,a=n.parent.parent.name,r=n.parent.name.substr(0,2),s=n.name.substr(0,3),i=he[a][r][s]["电"];t.value={"楼栋":a,"楼层":r,"房间号":s,"度数":i,name:n.name,type:"电",x:o.x,y:o.y,show:!0}}else t.value.show=!1},e.rayModel,"click")}function Be(e,t){e.selectedObjects=[],e.outlinePass.selectedObjects=e.selectedObjects,t.value.show=!1,e.destroyRaycaster()}function xe(e,t){e.flyTo({position:[53,68.1,132.1],controls:[-3.85,-12.06,8.96],done:()=>{ke(e,t)}})}function ke(e,t){let n=0;e.model.traverse(t=>{if(t.isMesh)if(-1===t.name.indexOf("水管"))t.material=P;else{const o=t.parent.parent.name,a=t.parent.name.substr(0,2),r=t.name.substr(0,3),s=he[o][a][r]["水"];s>15&&(e.selectedObjects.push(t),n<6&&(setTimeout(()=>{Object(Ae["a"])({title:"警告",message:`${o}的${a}${r}的用水量为${s}度, 已超过平均标准，请留意`,type:"warning",duration:6e3})},200*n),n++),e.rayModel.push(t))}}),e.initRaycaster((e,n,o)=>{if(e){const n=e.object,a=n.parent.parent.name,r=n.parent.name.substr(0,2),s=n.name.substr(0,3),i=he[a][r][s]["水"];t.value={"楼栋":a,"楼层":r,"房间号":s,"度数":i,name:n.name,type:"水",x:o.x,y:o.y,show:!0}}else t.value.show=!1},e.rayModel,"click")}function Ee(e,t){e.selectedObjects=[],e.outlinePass.selectedObjects=e.selectedObjects,t.value.show=!1,e.destroyRaycaster()}var Ce={name:"bigControl",components:{layer:q,tooltip:ce},props:{},data(){return{}},setup(){const e=Object(o["reactive"])({roomTooltipStyle:{name:"",type:"",x:0,y:0,show:!1}});let t=Object(o["ref"])(0);const n=Object(o["reactive"])({isShowFloorBack:!1,model:null}),a=Object(o["ref"])({name:"",type:"",x:0,y:0,show:!1}),r=Object(o["ref"])({name:"",type:"",x:0,y:0,show:!1}),s=Object(o["ref"])([]);let i=Object(o["ref"])(0);const l="全楼";let c=Object(o["ref"])("全楼"),d=Object(o["reactive"])([{name:"首页",goFunction:()=>{window.app.flyTo({position:window.app.cameraPostion,controls:window.app.controlsTarget,duration:1e3})},backFunction:()=>{}},{name:"楼层管理",goFunction:()=>{console.log("楼层管理"),n.isShowFloorBack=!1,ge(window.app,n)},backFunction:()=>{console.log("楼层管理返回"),n.model&&"全楼"!==c.value?(c.value="全楼",we(window.app,n.model,c.value,s,a),setTimeout(()=>{N(window.app)},1e3)):N(window.app),L(window.app,"floorText"),n.isShowFloorBack=!1,e.roomTooltipStyle.show=!1}},{name:"电力监测",goFunction:()=>{Oe(window.app,r)},backFunction:()=>{Be(window.app,r),N(window.app)}},{name:"水力监测",goFunction:()=>{xe(window.app,r)},backFunction:()=>{Ee(window.app,r),N(window.app)}}]);function u(e,n){t.value=n}function m(){n.isShowFloorBack=!1,e.roomTooltipStyle.show=!1,n.model&&"全楼"!==c.value?(c.value="全楼",we(window.app,n.model,c.value,s,a),setTimeout(()=>{N(window.app),ge(window.app,n),n.model=null},1e3)):(N(window.app),ge(window.app,n))}function p(e){c.value=e,we(window.app,n.model,e,s,a)}return Object(o["watch"])(t,(e,t)=>{const n=d.find(e=>{var n;return e.name===(null===(n=d[t])||void 0===n?void 0:n.name)});n&&n.backFunction();const o=d.find(t=>{var n;return t.name===(null===(n=d[e])||void 0===n?void 0:n.name)});o&&o.goFunction()}),Object(o["watch"])(n,e=>{if(e&&e.model){const e=n.model.children.filter(e=>e.name.indexOf("F")>-1).map(e=>e.name.substring(0,e.name.indexOf("F")+1));s.value=[l].concat(e)}}),Object(o["watch"])(a,t=>{if(t)if(t.name.indexOf("摄像头")>-1)e.roomTooltipStyle=Object.assign({"楼栋":n.model.name,"楼层":c.value,"摄像头":t.name,"视频":fe[t.name.substring(0,4)]},t);else{const o=t.name.substring(0,3);e.roomTooltipStyle=Object.assign({"楼栋":n.model.name,"楼层":c.value,"房间号":t.name,"度数":he[n.model.name][c.value][o][t.type]},t)}}),Object(o["watch"])(r,t=>{t&&(e.roomTooltipStyle=t)}),{activeFun:u,activeIndex:t,controls:d,EventBus:n,backFloorBase:m,changeLayer:p,currentLayer:c,currentFloor:i,layerData:s,tooltip:ce,tooltipInfo:a,state:e}}};n("58bb");const Pe=i()(Ce,[["render",Y],["__scopeId","data-v-01661784"]]);var Fe=Pe;function Se(e,t){const n=this;n.config={},n.init=function(){const o=new e;o.setSize(t.element.offsetWidth,t.element.offsetHeight),o.domElement.style.position="absolute",o.domElement.style.top="0px",o.domElement.style.pointerEvents="none",t.element.appendChild(o.domElement),n.CSSRender=o,n.cssRenderDomElement=o.domElement},n.add=function(e){let o=[];Array.isArray(e)?o=e:o.push(e),o.forEach(e=>{document.body.insertAdjacentHTML("beforeend",e.element);const o=new e.cssObject(document.body.lastChild);o.userData.isCss23D=!0,o.position.set(e.position[0],e.position[1],e.position[2]),o.name=e.name,e.scale&&o.scale.set(e.scale[0],e.scale[1],e.scale[2]),e.parent?e.parent.add(o):t.scene.add(o),n.config[e.name]=o})},n.removeAll=function(e){for(let t=e.children.length-1;t>=0;t--){let o=e.children[t],a=o.name;o.userData.isCss23D&&(e.remove(o),n.config[a]&&delete n.config[a])}},n.init()}var Me=n("32d9"),Te=n("93e9"),De=n("9ab2"),Ne=n("360d"),ze=n("4e15");function Le(e){f["m"].enabled=!1,e.bloomLayer=new f["H"],e.bloomLayer.set(1);const t=new Te["a"](e.scene,e.camera),n=new De["a"](new f["Mb"](window.innerWidth,window.innerHeight),1.5,.4,.85),o={exposure:.895,bloomThreshold:.164,bloomStrength:.6,bloomRadius:1};n.threshold=o.bloomThreshold,n.strength=o.bloomStrength,n.radius=o.bloomRadius;const a=new Me["a"](e.renderer);a.renderToScreen=!1,a.addPass(t),a.addPass(n);const r=new Ne["a"](new f["zb"]({uniforms:{baseTexture:{value:null},bloomTexture:{value:a.renderTarget2.texture}},vertexShader:"\n        varying vec2 vUv;\n\n        void main() {\n\n          vUv = uv;\n\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n        }\n      ",fragmentShader:"\n        uniform sampler2D baseTexture;\n        uniform sampler2D bloomTexture;\n\n        varying vec2 vUv;\n\n        void main() {\n\n          gl_FragColor = ( texture2D( baseTexture, vUv ) + vec4( 1.0 ) * texture2D( bloomTexture, vUv ) );\n\n        }\n      ",defines:{}}),"baseTexture");r.needsSwap=!0;const s=new Me["a"](e.renderer);s.addPass(t),s.addPass(r),e.finalComposer=s;const i=e.gui,l=i.addFolder("辉光");l.close(),e.renderer.toneMappingExposure=.895,l.add(o,"exposure",.1,2).onChange((function(t){e.renderer.toneMappingExposure=Math.pow(t,4)})),l.add(o,"bloomThreshold",0,1).onChange((function(e){n.threshold=Number(e)})),l.add(o,"bloomStrength",0,3).onChange((function(e){n.strength=Number(e)})),l.add(o,"bloomRadius",0,1).step(.01).onChange((function(e){n.radius=Number(e)})),l.open();const c=new ze["a"](new f["Mb"](e.element.offsetWidth,e.element.offsetHeight),e.scene,e.camera),d={edgeStrength:10,edgeGlow:1,edgeThickness:4,pulsePeriod:1};c.edgeStrength=d.edgeStrength,c.edgeGlow=d.edgeGlow,c.edgeThickness=d.edgeThickness,c.pulsePeriod=d.pulsePeriod,c.usePatternTexture=!1,e.selectedObjects=[],c.selectedObjects=e.selectedObjects,c.visibleEdgeColor.set("#ff0000"),c.hiddenEdgeColor.set("#ff0000"),e.outlinePass=c,a.addPass(c);const u=i.addFolder("边缘线");return u.close(),u.add(d,"edgeStrength",.01,10).onChange((function(e){c.edgeStrength=Number(e)})),u.add(d,"edgeGlow",0,1).onChange((function(e){c.edgeGlow=Number(e)})),u.add(d,"edgeThickness",1,4).onChange((function(e){c.edgeThickness=Number(e)})),u.add(d,"pulsePeriod",0,5).onChange((function(e){c.pulsePeriod=Number(e)})),a}let Ie,Ue,Re,He,Qe,Ve,Ge,Ke={};var We={name:"Home",components:{bigControl:Fe},setup(){const e=async()=>{Ie=new O("screen"),Ie.initZThree(),Ie.initControl(),Ie.initAmbientLight(),Ie.initDirectionalLight(),Ie.cameraPostion=[98.23,47.4,95.36],Ie.controlsTarget=[0,2.53,2.88],window.app=Ie,Ue=Ie.camera,Ue.position.set(...Ie.cameraPostion),Re=Ie.scene,Re.fog=new f["v"]("#000000",100,680),He=Ie.renderer,He.outputEncoding=f["xb"],He.toneMapping=f["a"],He.shadowMap.enabled=!0,He.shadowMap.type=f["jb"],Qe=Ie.controls,Qe.target.set(...Ie.controlsTarget),Qe.maxPolarAngle=Math.PI/2.2,Ve=new f["k"],await D(Ie);let e=new Se(de["a"],Ie);function t(e){e.isMesh&&!1===Ie.bloomLayer.test(e.layers)&&(Ke[e.uuid]=e.material,e.material=F)}function n(e){Ke[e.uuid]&&(e.material=Ke[e.uuid],delete Ke[e.uuid])}Ie.cssRender=e,Ie.instance=e,Ge=Le(Ie),Ie.render(()=>{let e=Ve.getDelta();Qe.update(e),Re.traverse(t),Ge.render(),Re.traverse(n),Ie.finalComposer.render(),Ie.cssRender.CSSRender.render(Re,Ue),x&&(x.offset.y-=.001),k&&(k.offset.x-=.001),E&&(E.offset.x-=.001),A["a"].update()})};return Object(o["onMounted"])(()=>{e()}),{}}};n("6f59"),n("b708");const Ye=i()(We,[["render",h]]);var Xe=Ye;const _e=[{path:"/",name:"Home",component:Xe},{path:"/about",name:"About",component:()=>n.e("chunk-2d22d746").then(n.bind(null,"f820"))}],Je=Object(u["a"])({history:Object(u["b"])(),routes:_e});var Ze=Je,qe=n("5502"),$e=Object(qe["a"])({state:{},mutations:{},actions:{},modules:{}});n("7d05"),n("641b"),n("b059"),n("0fae");const et=Object(o["createApp"])(d);et.use($e).use(Ze).mount("#app")},"58bb":function(e,t,n){"use strict";n("ef46")},"5e37":function(e,t,n){},"641b":function(e,t,n){},"6f59":function(e,t,n){"use strict";n("3aea")},"7d05":function(e,t,n){},b059:function(e,t,n){},b708:function(e,t,n){"use strict";n("3145")},bff5:function(e,t,n){"use strict";n("102d")},cc23:function(e,t,n){"use strict";n("5e37")},cc40:function(e,t,n){"use strict";n("4343")},ef46:function(e,t,n){}});
//# sourceMappingURL=app.284bfe9e.js.map